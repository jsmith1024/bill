#!/usr/bin/bash

here=`pwd`
# echo ${here}

doxyfiles=("DoxyLangman" "DoxyRefman"            "DoxyUserman"      "DoxyStlman")
locations=("langman"     "refman"                "userman"          "stlman")
books=(    "Bill_Primer" "reference_manual"      "user_manual"      "standard_library_reference")
names=(    "Bill_Primer" "Bill_Reference_Manual" "Bill_User_Manual" "Bill_Standard_Library_Reference")

# html forward and config
cp dox/index.html  docs/index.html
cp dox/_config.yml docs/_config.yml

# html docs
doxyfile="dox/DoxyHome"
if [ -f ${doxyfile} ]
	then
		doxygen ${doxyfile}
		retVal=$?
		if [ $retVal -ne 0 ]
		then
            echo "Error: exit code ${$retVal} on ${doxyfile}."
            exit $retVal
        fi
fi

# pdf docs
for i in {0..3}
do
    doxyfile="dox/books/${books[i]}/${doxyfiles[i]}"
    if [ -f ${doxyfile} ]
        then
            doxygen ${doxyfile}
            retVal=$?
            if [ $retVal -ne 0 ]
            then
                echo "Error: exit code ${$retVal} on doxygen ${doxyfile}."
                exit $retVal
            fi
            cd /tmp/bill/${locations[i]}/latex
            make
            retVal=$?
            if [ $retVal -ne 0 ]
            then
                echo "Error: exit code ${retVal} on Make of ${doxyfile}."
                exit $retVal
            fi
            cd $here
            mv /tmp/bill/${locations[i]}/latex/refman.pdf docs/${names[i]}.pdf
    else
        echo -e "\n========\nInfo: ${doxyfile} does not exist.\n========\n"
    fi
done
